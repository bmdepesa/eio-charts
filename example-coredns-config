replicaCount: 2
exposeHostPort: true
isClusterService: false
image:
  repository: rancher/coredns
  tag: v1.5.0-1-rancher-amd64
  pullPolicy: Always
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
    - labelSelector:
        matchExpressions:
        - key: app
          operator: In
          values:
          - coredns
      topologyKey: "kubernetes.io/hostname"
labels:
  app: coredns
servers:
- zones:
  - zone: .
  port: 53
  plugins:
  - name: rrl
    parameters: .
    configBlock: |-
      window 15
      ipv4-prefix-length 24
      ipv6-prefix-length 56
      responses-per-second 0
      nodata-per-second 10
      nxdomains-per-second 10
      referrals-per-second 10
      errors-per-second 10
      max-table-size 100000
  - name: file
    parameters: /etc/coredns/api.onrio.eng.rancher.space.dbfile api.onrio.eng.rancher.space
    configBlock: |-
      reload 0
  - name: etcd
    parameters: onrio.eng.rancher.space
    configBlock: |-
      path /rdns
      endpoint http://etcd-cluster:2379
      upstream 1.1.1.1:53 1.0.0.1:53
      wildcardbound 5
  - name: cache
    parameters: 60 onrio.eng.rancher.space
  - name: loadbalance
  - name: prometheus
    parameters: 0.0.0.0:9153
  - name: log
  - name: errors
  - name: health
zoneFiles:
  - filename: api.onrio.eng.rancher.space.dbfile
    domain: api.onrio.eng.rancher.space
    contents: |
      $ORIGIN api.onrio.eng.rancher.space.     ; designates the start of this zone file in the namespace
      $TTL 1h                           ; default expiration time of all resource records without their own TTL value
      @                                       IN  SOA      ns1.onrio.eng.rancher.space. on-rio.rancher.com. 1 3h 1h 1w 1h
      @                                       IN A 54.71.227.176
      @                                       IN A 52.27.122.77
